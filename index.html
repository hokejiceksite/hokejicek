<!doctype html>
<html lang="cs">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>HOKEJICEK.site</title>
<link rel="icon" href="/H.png">

<style>
:root{
  --bg:#0a0e18;
  --grad:linear-gradient(135deg,#0b1224,#121c38);
  --border:rgba(255,255,255,.1);
  --text:#ffffff;
  --muted:rgba(255,255,255,.65);
  --max:1600px;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui}
a{text-decoration:none;color:inherit}

#_wauysh,#_wauysh img,a[href*="waust.at"]{display:none!important}

.nav{position:sticky;top:0;background:rgba(10,14,24,.9);border-bottom:1px solid var(--border)}
.nav-inner{max-width:var(--max);margin:auto;padding:14px 16px;display:flex;justify-content:space-between}
.brand{font-weight:900;font-size:20px}

.wrapper{max-width:var(--max);margin:auto;padding:16px}
.grid{display:grid;grid-template-columns:360px 1fr 360px;gap:16px}
@media(max-width:1200px){.grid{grid-template-columns:1fr}}

.panel{background:var(--grad);border:1px solid var(--border);border-radius:18px;overflow:hidden}
.panel-head{padding:14px 16px;font-weight:900;border-bottom:1px solid var(--border)}

.schedule{padding:12px;display:grid;gap:12px;max-height:75vh;overflow-y:auto}

.league{border:1px solid var(--border);border-radius:14px;background:rgba(0,0,0,.25)}
.league-head{padding:14px 16px;font-weight:900;cursor:pointer;display:flex;justify-content:space-between}
.league-body{display:none;padding:10px 14px 14px;gap:8px}
.league.open .league-body{display:grid}

.match{padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:rgba(0,0,0,.35);cursor:pointer}
.match-title{font-weight:800}
.match-meta{font-size:13px;color:var(--muted)}

.player-wrap{padding:16px}
.video{width:100%;aspect-ratio:16/9;background:#000;border-radius:16px;overflow:hidden}
.video iframe{width:100%;height:100%;border:0}

.stream-bar{display:flex;gap:10px;padding-top:10px;overflow-x:auto}
.stream-btn{min-width:100px;height:40px;border-radius:14px;border:1px solid var(--border);background:#1a233d;color:#fff;font-weight:800;cursor:pointer}
.stream-btn.active{background:#2b4cff}

.chat-body{height:75vh}
.chat-body iframe{width:100%;height:100%;border:0}
</style>

<script id="aclib" src="//acscdn.com/script/aclib.js"></script>
</head>

<body>

<div class="nav">
  <div class="nav-inner">
    <div class="brand">HOKEJICEK.site</div>
  </div>
</div>

<div class="wrapper">
  <div class="grid">

    <div class="panel">
      <div class="panel-head">Rozpis</div>
      <div class="schedule" id="schedule">Načítám…</div>
    </div>

    <div class="panel">
      <div class="panel-head">Přenos</div>
      <div class="player-wrap">
        <div class="video" id="player"></div>
        <div class="stream-bar" id="streamButtons"></div>
      </div>
    </div>

    <div class="panel">
      <div class="panel-head">Live chat</div>
      <div class="chat-body">
        <iframe src="https://hokejicek.site/livechat"></iframe>
      </div>
    </div>

  </div>
</div>

<script>
const API_URL="https://onhockey.long-mode-0a14.workers.dev/";
const schedule=document.getElementById("schedule");
const player=document.getElementById("player");
const buttons=document.getElementById("streamButtons");

function decodeHtml(t){
  const x=document.createElement("textarea");
  x.innerHTML=t;
  return x.value;
}

function makeEmbed(url){
  return `
<iframe
  src="${url}"
  allow="autoplay; fullscreen; encrypted-media; picture-in-picture"
  allowfullscreen
  referrerpolicy="no-referrer"
  sandbox="allow-same-origin allow-scripts allow-forms allow-presentation"
  loading="eager">
</iframe>`;
}

fetch(API_URL)
.then(r=>r.json())
.then(json=>{
  schedule.innerHTML="";
  json.data.forEach(l=>{
    if(!l.games?.length) return;

    const league=document.createElement("div");
    league.className="league";

    const head=document.createElement("div");
    head.className="league-head";
    head.innerHTML=`<span>${decodeHtml(l.league)}</span><span>▶</span>`;
    head.onclick=()=>league.classList.toggle("open");

    const body=document.createElement("div");
    body.className="league-body";

    l.games.forEach(g=>{
      const m=document.createElement("div");
      m.className="match";
      m.innerHTML=`<div class="match-title">${decodeHtml(g.teams)}</div><div class="match-meta">${g.time}</div>`;
      m.onclick=()=>{
        buttons.innerHTML="";
        player.innerHTML="";
        if(!g.links?.length){
          player.innerHTML="Stream není dostupný";
          return;
        }
        g.links.forEach((ln,i)=>{
          const b=document.createElement("button");
          b.className="stream-btn";
          b.textContent=ln.label.toUpperCase();
          b.onclick=()=>{
            document.querySelectorAll(".stream-btn").forEach(x=>x.classList.remove("active"));
            b.classList.add("active");
            player.innerHTML=makeEmbed(ln.url);
          };
          buttons.appendChild(b);
          if(i===0) b.click();
        });
      };
      body.appendChild(m);
    });

    league.appendChild(head);
    league.appendChild(body);
    schedule.appendChild(league);
  });
});
</script>

<script>
if(typeof aclib!=="undefined"){
  aclib.runAutoTag({zoneId:"zitkptgwk8"});
}
</script>

<script id="_wauysh">
var _wau=_wau||[];
_wau.push(["classic","fli48hy375","ysh"]);
</script>
<script async src="//waust.at/c.js"></script>

</body>
</html>
