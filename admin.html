<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Admin Panel | Hokej√≠ƒçek</title>
<style>
body {
  background-color: #0a0a0a;
  color: #e0e0e0;
  font-family: "Segoe UI", Arial, sans-serif;
  margin: 0;
  padding: 40px;
  display: flex;
  justify-content: center;
}

.container {
  background-color: #111;
  padding: 30px 40px;
  border-radius: 20px;
  width: 700px;
  box-shadow: 0 0 30px rgba(0,0,0,0.7);
}

h1 {
  color: #fff;
  text-align: center;
  margin-bottom: 0;
}

h2 {
  color: #bbb;
  text-align: center;
  font-weight: normal;
  margin-top: 5px;
  margin-bottom: 30px;
}

input, textarea {
  width: 100%;
  padding: 10px;
  margin: 8px 0;
  border-radius: 8px;
  border: none;
  background: #222;
  color: #fff;
}

button {
  background-color: #3a82f7;
  border: none;
  color: white;
  padding: 10px 18px;
  border-radius: 10px;
  cursor: pointer;
  transition: 0.2s;
}

button:hover {
  background-color: #2f6ee0;
}

.stream {
  background: #1a1a1a;
  border-radius: 15px;
  padding: 15px;
  margin-top: 20px;
  box-shadow: 0 0 10px rgba(0,0,0,0.4);
}

.stream-title {
  font-weight: bold;
  color: #6fa8ff;
  margin-bottom: 5px;
}

.stream-actions {
  margin-top: 8px;
}

.stream-actions button {
  margin-right: 6px;
  background: #2b2b2b;
  color: #6fa8ff;
}

.stream-actions button:hover {
  background: #3a82f7;
  color: white;
}
#adminPanel { display:none; }
</style>
</head>
<body>

<div class="container">
  <h1>Admin Panel</h1>
  <h2>Spr√°va p≈ôenos≈Ø</h2>

  <div id="loginBox">
    <input id="email" placeholder="E-mail">
    <input id="password" type="password" placeholder="Heslo">
    <button id="loginBtn">P≈ôihl√°sit se</button>
    <p id="loginError"></p>
  </div>

  <div id="adminPanel">
    <label>N√°zev z√°pasu:</label>
    <input id="title" placeholder="Nap≈ô. HC Vla≈°im vs HC Bene≈°ov">

    <label>Datum a ƒças:</label>
    <input id="date" placeholder="Nap≈ô. 2025-10-20 17:30">

    <label>Odkaz na p≈ôenos:</label>
    <input id="url" placeholder="https://example.com/stream.m3u8">

    <button id="addBtn">P≈ôidat p≈ôenos</button>
    <p id="status"></p>

    <div id="streamList"></div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAjDSUsGEEw1js7tlEiF98Sp0ZYyfhHxa4",
  authDomain: "hokejicek-65a98.firebaseapp.com",
  projectId: "hokejicek-65a98",
  storageBucket: "hokejicek-65a98.firebasestorage.app",
  messagingSenderId: "699646619013",
  appId: "1:699646619013:web:3672cd198683e1e035e8ec",
  measurementId: "G-3YEPQ41LYX"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

const loginBox = document.getElementById("loginBox");
const adminPanel = document.getElementById("adminPanel");
const streamList = document.getElementById("streamList");

document.getElementById("loginBtn").onclick = async () => {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  try {
    await auth.signInWithEmailAndPassword(email, password);
  } catch (e) {
    document.getElementById("loginError").innerText = "‚ùå " + e.message;
  }
};

auth.onAuthStateChanged(user => {
  if (user) {
    loginBox.style.display = "none";
    adminPanel.style.display = "block";
    loadStreams();
  } else {
    loginBox.style.display = "block";
    adminPanel.style.display = "none";
  }
});

async function loadStreams() {
  const snapshot = await db.collection("streams").orderBy("date", "asc").get();
  streamList.innerHTML = "";
  snapshot.forEach(doc => {
    const s = doc.data();
    const div = document.createElement("div");
    div.className = "stream";
    div.innerHTML = `
      <div class="stream-title">üé• ${s.title}</div>
      <div>${s.date}</div>
      <a href="${s.url}" target="_blank" style="color:#6fa8ff">${s.url}</a>
      <div class="stream-actions">
        <button onclick="editStream('${doc.id}','${s.title}','${s.date}','${s.url}')">‚úèÔ∏è Upravit</button>
        <button onclick="deleteStream('${doc.id}')">üóëÔ∏è Smazat</button>
      </div>
    `;
    streamList.appendChild(div);
  });
}

document.getElementById("addBtn").onclick = async () => {
  const title = document.getElementById("title").value;
  const date = document.getElementById("date").value;
  const url = document.getElementById("url").value;
  if (!title || !date || !url) {
    document.getElementById("status").innerText = "‚ö†Ô∏è Vypl≈à v≈°echna pole!";
    return;
  }
  await db.collection("streams").add({ title, date, url });
  document.getElementById("status").innerText = "‚úÖ P≈ôenos p≈ôid√°n!";
  document.getElementById("title").value = "";
  document.getElementById("date").value = "";
  document.getElementById("url").value = "";
  loadStreams();
};

async function deleteStream(id) {
  if (confirm("Opravdu smazat tento p≈ôenos?")) {
    await db.collection("streams").doc(id).delete();
    loadStreams();
  }
}

function editStream(id, title, date, url) {
  document.getElementById("title").value = title;
  document.getElementById("date").value = date;
  document.getElementById("url").value = url;
  document.getElementById("status").innerHTML = `‚úèÔ∏è √öprava p≈ôenosu... <button onclick="saveEdit('${id}')">Ulo≈æit zmƒõny</button>`;
}

async function saveEdit(id) {
  const title = document.getElementById("title").value;
  const date = document.getElementById("date").value;
  const url = document.getElementById("url").value;
  await db.collection("streams").doc(id).update({ title, date, url });
  document.getElementById("status").innerText = "‚úÖ Zmƒõny ulo≈æeny!";
  loadStreams();
}
</script>
</body>
</html>
