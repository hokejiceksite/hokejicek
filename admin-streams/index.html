  <!-- 🔥 Firebase logika -->
  <script>
    // Inicializace Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyDzLNoTKVC8GfcZsARHlmlgmF2eXlC858c",
      authDomain: "hokejicek-streamy.firebaseapp.com",
      databaseURL: "https://hokejicek-streamy-default-rtdb.firebaseio.com/",
      projectId: "hokejicek-streamy",
      storageBucket: "hokejicek-streamy.firebasestorage.app",
      messagingSenderId: "747005458237",
      appId: "1:747005458237:web:835917780e34b1f1757754"
    };

    // ⚙️ Spuštění Firebase
    firebase.initializeApp(firebaseConfig);

    // 🧱 Inicializace služeb (musí být hned po initializeApp)
    const auth = firebase.auth();
    const db = firebase.database();

    // 🧩 Teprve potom definujeme zbytek logiky
    const loginBox = document.getElementById("loginBox");
    const adminPanel = document.getElementById("adminPanel");
    const table = document.getElementById("streamTable");
    const statusText = document.getElementById("status");

    // ✅ Kontrola připojení k databázi
    db.ref(".info/connected").on("value", (snap) => {
      statusText.textContent = snap.val()
        ? "✅ Připojeno k Firebase"
        : "❌ Nepřipojeno";
    });

    // 🔑 Přihlášení
    function login() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      // Ujisti se, že je Firebase načteno
      if (!auth) {
        alert("❌ Firebase Auth se nenačetlo správně. Zkontroluj skripty nahoře.");
        return;
      }

      auth.signInWithEmailAndPassword(email, password)
        .then(() => {
          console.log("✅ Přihlášení OK");
          loginBox.style.display = "none";
          adminPanel.style.display = "block";
          loadStreams();
        })
        .catch(error => {
          console.error("❌ Chyba přihlášení:", error);
          document.getElementById("errorMsg").textContent =
            "❌ Firebase hlásí: " + error.code + " – " + error.message;
        });
    }

    // 🚪 Odhlášení
    function logout() {
      auth.signOut().then(() => location.reload());
    }

    // 📡 Načtení streamů
    function loadStreams() {
      table.innerHTML = "";
      for (let i = 1; i <= 20; i++) {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td><a href="/stream${i}.html" target="_blank">/stream${i}</a></td>
          <td><input id="input${i}" type="text" placeholder="Vlož odkaz..."></td>
          <td><button onclick="saveStream(${i})">💾</button></td>
        `;
        table.appendChild(tr);

        db.ref("streams/stream" + i).on("value", (snapshot) => {
          const val = snapshot.val();
          if (val && val.url) document.getElementById("input" + i).value = val.url;
        });
      }
    }

    // 💾 Uložení streamu
    function saveStream(num) {
      const input = document.getElementById("input" + num).value;
      db.ref("streams/stream" + num).set({ url: input });
      alert(`✅ Stream ${num} uložen.`);
    }
  </script>
